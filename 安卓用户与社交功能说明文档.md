📱 iSpot 安卓前端功能说明文档（用户与社交模块）
🧩 一、项目概述

本应用为一款模拟社交定位平台 iSpot 的安卓前端实现，
主要功能包括：

用户注册 / 登录

用户资料展示与编辑

动态发布、浏览与点赞

本地 Fake 后端服务（FakeApiService）模拟交互

应用采用 Kotlin + Retrofit + RecyclerView 技术栈构建，
不依赖真实服务器，通过 FakeApiService 模拟后端行为，方便本地调试。

🧠 二、架构结构
com.ispot.android
├── data
│   ├── model               # 数据模型（User, Post）
│   ├── network             # 网络层（ApiService、FakeApiService、FakeCall）
│   ├── repository          # 数据仓库（UserRepository、PostRepository）
│   └── network/dto         # 网络请求与响应模型（LoginRequest, RegisterResponse 等）
├── ui
│   ├── login               # 登录页面 LoginActivity
│   ├── register            # 注册页面 RegisterActivity
│   ├── feed                # 动态列表 FeedFragment、PostAdapter
│   ├── post                # 发布动态 PostActivity
│   └── user                # 用户信息页 UserActivity
└── utils                   # 辅助工具（SessionManager）

👤 三、用户模块（User Module）
1️⃣ 登录功能（LoginActivity）

功能描述：
用户输入用户名与密码，点击登录后调用 FakeApiService.login() 模拟后端验证。

主要逻辑：

NetworkModule.apiService.login(LoginRequest(u, p))
    .enqueue(object : Callback<LoginResponse> {
        override fun onResponse(...) {
            val body = response.body()
            if (body?.user != null) {
                session.saveToken(body.token ?: "")
                session.saveUserId(body.user.id)
                startActivity(Intent(this@LoginActivity, FeedActivity::class.java))
            } else {
                Toast.makeText(..., "用户名或密码错误", ...)
            }
        }
    })


状态管理：

使用 SessionManager 保存登录 token 和 userId

登录成功自动跳转至 FeedActivity

2️⃣ 注册功能（RegisterActivity）

功能描述：
输入用户名与密码，点击注册，调用 FakeApiService.register() 进行模拟注册。

逻辑：

NetworkModule.apiService.register(RegisterRequest(u, p, n))
    .enqueue(object : Callback<RegisterResponse> {
        override fun onResponse(...) {
            Toast.makeText(..., body.message, ...)
        }
    })


本地验证：

检查输入是否为空

若用户名已存在（Fake 内部校验），返回提示信息

3️⃣ 用户信息页（UserActivity）

功能描述：
显示当前登录用户的基本资料（头像、昵称、简介），可编辑并保存。

关键点：

获取当前用户信息 → UserRepository.getUser(userId)

编辑资料后 → FakeApiService.updateUser(user)

更新成功后弹出提示并返回上层界面

支持字段：

昵称（nickname）

头像地址（avatarUrl）

简介（bio）

🗞️ 四、动态模块（Feed / Post Module）
1️⃣ 动态列表（FeedFragment）

功能描述：
展示所有用户动态（由 FakeApiService.getAllPosts() 提供），支持点赞。

UI 组件：

RecyclerView + PostAdapter

每条动态展示：

用户头像 / 昵称

内容文本

发布时间（timestamp 转换）

点赞按钮（点击调用 likePost）

逻辑：

NetworkModule.apiService.getAllPosts()
    .enqueue(object : Callback<List<Post>> { ... })


点赞功能：

NetworkModule.apiService.likePost(postId)


本地模拟增加 likeCount 并刷新列表。

2️⃣ 发布动态（PostActivity）

功能描述：
输入文字内容，点击发布后调用 FakeApiService.createPost() 创建新动态。

逻辑：

val request = CreatePostRequest(userId, content, imageUrl)
NetworkModule.apiService.createPost(request)
    .enqueue(object : Callback<Post> { ... })


成功后：

显示“发布成功”

跳转回 Feed 页面并刷新

💾 五、数据与请求模型
类名	用途	主要字段
User	用户模型	id, username, password, nickname, avatarUrl, bio, lastActiveTime
Post	动态模型	id, userId, content, imageUrl, timestamp, likeCount
LoginRequest	登录请求体	username, password
LoginResponse	登录响应体	success, message, user, token
RegisterRequest	注册请求体	username, password, nickname
RegisterResponse	注册响应体	success, message
CreatePostRequest	发帖请求体	userId, content, imageUrl
🧩 六、核心类说明
🔹 FakeApiService

本地模拟后端接口实现，提供：

用户注册、登录、更新资料

动态创建、点赞、获取列表

内部使用 FakeCall 模拟 Retrofit 的异步回调。

🔹 FakeCall

实现 Call<T> 接口，立即返回 Response.success(...)，
用于无网络环境下测试 Retrofit 回调逻辑。

🔹 NetworkModule

统一提供 apiService 实例。
目前返回 FakeApiService()，可替换为真实 Retrofit 服务。
